function parseDate(t){var s=t.split("/");return new Date(s[2],s[1]-1,s[0])}function daysEllapsed(t,s){return Math.abs(Math.round((s-t)/864e5))}var canvas=document.getElementById("main"),c=canvas.getContext("2d");canvas.width=window.innerWidth,canvas.height=window.innerHeight;var w=window.innerWidth,h=window.innerHeight,info=document.getElementById("infoContent"),systemHealth=document.getElementById("system_health"),systemDeadDeebs=document.getElementById("system_dead"),systemYourFault=document.getElementById("system_yourFault"),alertBox=document.getElementById("alertBox"),jsonObjects=[],deebs=[],critterArray=[],runCount=0,archiveImages=[],myImages=[],myDeebs,systemInfo,points=100,mouseX=w+200,mouseY=h+200;document.onmousemove=function(t){mouseX=t.clientX,mouseY=t.clientY},document.onmouseleave=function(t){mouseX=w+200,mouseY=h+200};var dFills=[],dStroke,ddFills=[],ddStroke,deeb={};deeb.init=function(t,s,i,h){this.type="deeb",this.index=i,this.xPos=t,this.yPos=s,this.state=1,this.name=h,this.bodyWidth=random(100,150),this.bodyHeight=130+random(-10,20),this.points=random(0,.4*this.bodyWidth),this.scared=!1,this.scaredCount=0,this.fill=dFills[0],this.bFill=dFills[1],this.stroke=dStroke,this.speed=random(3,4,!1),random(0,1)<1&&(this.speed=-this.speed),this.eyeSize=random(20,30,!1),this.mouthWidth=random(5,15),this.startHeight=this.bodyHeight,this.slugCount=random(0,10,!1),this.slugPeriod=random(40,70),this.drawBody(t,s)},deeb.setup=function(t,s,i,h,e,o,n,a,r){this.type="deeb",this.points=h,this.index=r,this.xPos=t,this.yPos=s,this.name=i,this.hover=!1,this.state=n,this.bodyWidth=e,this.bodyHeight=o,this.scared=!1,this.scaredCount=0,this.fill=dFills[0],this.bFill=dFills[1],this.stroke=dStroke,this.speed=random(map(points,400,0,1,3),map(points,400,0,1,5)+1,!1),random(0,1)<1&&(this.speed=-this.speed),this.eyeSize=random(20,30,!1),this.mouthWidth=random(5,15),this.startHeight=this.bodyHeight,this.slugCount=random(0,10,!1),this.slugPeriod=random(40,70),this.drawBody(t,s)},deeb.update=function(){var t=this.bodyWidth+map(points,400,0,-75,50);if(0==this.state&&(t=this.bodyWidth+map(this.points,0,200,-75,50)),this.hover)if(this.points+=.05,this.scared=!0,400-points<=this.points&&0!=this.state){this.state=0;var s=new Audio("../assets/sounds/bell.wav");s.play(),alertBox.innerHTML="STOP",setTimeout(function(){alertBox.innerHTML="..."},2e3)}else 400-points<=this.points&&0==this.state?(alertBox.innerHTML="R.I.P. "+this.name,setTimeout(function(){alertBox.innerHTML="..."},2e3)):(alertBox.innerHTML="Stop scaring "+this.name+"!",setTimeout(function(){alertBox.innerHTML="..."},2e3));if(0==this.state)this.speed=0,this.fill=ddFills[0],this.bFill=ddFills[1];else{this.xPos+=this.speed,this.speed>0?this.xPos>w+this.bodyWidth&&(this.xPos=-100,this.yPos=random(100,h-100)):this.xPos<-100&&(this.xPos=w+100,this.yPos=random(100,h-100)),this.slugCount++;var i=7,e=Math.sin(this.slugCount/this.slugPeriod*2*Math.PI+Math.PI)*i;this.bodyHeight=this.startHeight+e}this.drawBody(this.xPos,this.yPos)},deeb.drawBody=function(t,s){var i=this.bodyWidth+map(points,400,0,-75,50);0==this.state&&(i=this.bodyWidth+map(this.points,0,200,-75,50)),fill(this.bFill),stroke(this.stroke),pEllipse(t,s-this.bodyHeight+i/2,i,i,179,360),fill(this.fill),fEllipse(t,s-this.bodyHeight+i/2,.8*i,.9*i,179,360),fill(this.bFill),fRect(t-i/2,s-this.bodyHeight+i/2-1,i,this.bodyHeight-i/2),fill(this.fill),fRect(t-.8*i/2,s-this.bodyHeight+i/2-2,.8*i,this.bodyHeight-i/2),pLine(t-i/2,s-this.bodyHeight+i/2-2,t-i/2,s-2),pLine(t+i/2,s-this.bodyHeight+i/2-2,t+i/2,s-2),pLine(t-i/2,s-2,t+i/2,s-2),this.face()},deeb.face=function(){this.pupilSize=2;var t=map(points,400,100,.6*this.eyeSize,this.eyeSize),s=.75*this.bodyHeight,i=.95*this.bodyHeight,h=Math.max(s,Math.min(map(points,400,200,s,i),i)),e=map(points,400,0,-20,20);1==this.scared&&(this.pupilSize=.25*t,this.scaredCount++,this.speed=-this.speed,e>3&&(e=1),1==e&&(this.mouthWidth=5),this.scaredCount>6&&(this.scared=!1,this.scaredCount=0)),fill("white");for(var o=-2;3>o;o+=4)fEllipse(this.xPos-10*o,this.yPos-h,t,t);if(fill("black"),0==this.state){for(var o=-2;3>o;o+=4)stroke("grey"),pEx(this.xPos+10*o,this.yPos-h,5,5);t=.6*this.eyeSize}else for(var o=-2;3>o;o+=4)ellipse(this.xPos+10*o,this.yPos-h,this.pupilSize);noFill(),stroke("grey"),0!=this.state&&(e>-5&&5>e?pLine(this.xPos-this.mouthWidth,this.yPos-h+20,this.xPos+this.mouthWidth,this.yPos-h+20):pEllipse(this.xPos,this.yPos-h+20,2*this.mouthWidth,e,0,180))};var flower={};flower.setup=function(t,s){this.type="flower",this.xPos=t,this.yPos=s,this.hover=!1;var i=27+random(-20,20),h=map(points,200,400,100,40),e=map(points,200,400,70,50)+random(-10,10);200>=points?(e=60,h=100):points>=400&&(e=40,h=40),this.fill="hsla("+i+", "+h+"%, "+e+"%, 1)",this.stroke="hsla(358, "+h+"%, "+(e+10)+"%, 1)",this.flowerCount=random(3,5),this.stemLengths=[],this.stemOffsets=[],this.flowerSizes=[];for(var o=0;o<this.flowerCount;o++)this.stemLengths[o]=random(30,100),this.stemOffsets[o]=random(-45,45),this.flowerSizes[o]=random(15,30)},flower.update=function(){stroke(this.stroke),fill(this.fill);for(var t=0;t<this.flowerCount;t++)this.drawStem(this.xPos,this.yPos,this.xPos+this.stemOffsets[t],this.yPos-this.stemLengths[t],this.flowerSizes[t]);this.hover&&(alertBox.innerHTML="Please, don't pick the flowers!",setTimeout(function(){alertBox.innerHTML="..."},2e3))},flower.drawStem=function(t,s,i,h,e){pLine(t,s,i,h),pEllipse(i,h,e,e)};var plant={};plant.setup=function(t,s){this.type="plant",this.xPos=t,this.yPos=s,this.hover=!1;var i=map(points,200,400,60,40),h=map(points,200,400,100,80),e=map(points,200,400,60,40);200>=points?(i=60,h=100,e=60):points>=400&&(i=40,h=80,e=40),this.fill="hsla("+e+", 100%, "+i+"%, 1)",this.stroke="hsla("+(e-5)+", 100%, "+i+"%, 1)",this.width=30,this.height=random(75,135),this.loop=0,this.images=[],tempCanvas.width=this.width,tempCanvas.height=this.height,setCanvas(tempC);for(var o=0;3>o;o++)this.draw(),this.images[o]=new Image,this.images[o].src=tempCanvas.toDataURL();resetCanvas()},plant.draw=function(){stroke(this.stroke),fill(this.fill),pLine(this.width/2,this.height,this.width/2,this.height-100),pEllipse(this.width/2,this.height-(this.height-35),30,30),pEllipse(this.width/2,this.height-(this.height-20),20,20),pEllipse(this.width/2,this.height-(this.height-8),10,10)},plant.update=function(){this.loop++,this.loop>=3&&(this.loop=0),c.drawImage(this.images[this.loop],this.xPos,this.yPos-this.height)};var bush={};bush.setup=function(t,s){this.type="bush",this.xPos=t,this.yPos=s,this.hover=!1,this.loop=0;var i=map(points,200,400,60,40),h=map(points,200,400,100,40);200>=points?(i=60,h=100):points>=400&&(i=40,h=40),this.fill="hsla(360, "+h+"%, "+i+"%, 1)",this.stroke="hsla(368, "+h+"%, "+(i+10)+"%, 1)",this.width=random(100,150),this.height=random(100,150),this.images=[],tempCanvas.width=this.width,tempCanvas.height=this.height,setCanvas(tempC);for(var e=0;3>e;e++)this.draw(),this.images[e]=new Image,this.images[e].src=tempCanvas.toDataURL();resetCanvas()},bush.draw=function(){background(),stroke(this.stroke),fill(this.fill),pEllipse(this.width/2,this.height,this.width-2,this.height,180,360)},bush.update=function(){this.loop++,this.loop>=3&&(this.loop=0),c.drawImage(this.images[this.loop],this.xPos,this.yPos-this.height)};var grass={};grass.setup=function(t,s){this.type="grass",this.xPos=t,this.yPos=s;var i=map(points,200,400,100,10);200>=points?i=100:points>=400&&(i=10),this.stroke="hsla(290, "+i+"%, 30%, 1)",this.bladeCount=random(2,5),this.bladeLengths=[];for(var h=0;h<this.bladeCount;h++)this.bladeLengths[h]=random(5,20)},grass.update=function(){stroke(this.stroke);for(var t=0;t<this.bladeCount;t++)pLine(this.xPos-7*t,this.yPos,this.xPos-7*t,this.yPos-this.bladeLengths[t])};var rock={};rock.setup=function(t,s){this.type="rock",this.xPos=t,this.yPos=s,this.hover=!1,this.fill="#8B408F";var i=map(points,200,400,65,10),h=map(points,200,400,45,45);200>=points?(i=65,h=45):points>=400&&(i=10,h=45),this.fill="hsla(290, "+i+"%, "+h+"%, 1)",this.stroke="hsla(290, "+i+"%, "+(h-10)+"%, 1)",this.loop=0,this.width=random(100,300),this.height=random(100,150),this.sectionCount=random(2,5),this.sectionXOffsets=[],this.sectionYPoss=[],this.sectionHeights=[],this.sectionWidths=[];for(var e=0;e<this.sectionCount;e++){this.sectionWidths[e]=random(40,100),this.sectionHeights[e]=random(30,150);var o=this.width-this.sectionWidths[e];this.sectionXOffsets[e]=random(o,this.width-o)}this.images=[],tempCanvas.width=this.width,tempCanvas.height=this.height,setCanvas(tempC);for(var e=0;3>e;e++)this.draw(),this.images[e]=new Image,this.images[e].src=tempCanvas.toDataURL();resetCanvas()},rock.draw=function(){stroke(this.stroke),fill(this.fill);for(var t=0;t<this.sectionCount;t++)pEllipse(this.sectionXOffsets[t]-this.sectionWidths[t]/2,this.height,this.sectionWidths[t],this.sectionHeights[t],180,360)},rock.update=function(){this.hover&&(alertBox.innerHTML="Just a rock.",setTimeout(function(){alertBox.innerHTML="..."},2e3)),this.loop++,this.loop>=3&&(this.loop=0),c.drawImage(this.images[0],this.xPos,this.yPos-this.height)};